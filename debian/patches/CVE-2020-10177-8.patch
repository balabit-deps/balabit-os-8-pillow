From 5b490fc413dfab2d52de46a58905c25d9badb650 Mon Sep 17 00:00:00 2001
From: Eric Soroos <eric-github@soroos.net>
Date: Tue, 10 Mar 2020 20:17:33 +0000
Subject: [PATCH 09/11] additional FLI check

---
 src/libImaging/FliDecode.c | 1 +
 1 file changed, 1 insertion(+)

diff --git a/src/libImaging/FliDecode.c b/src/libImaging/FliDecode.c
index 16ddf3a49f..108e1edf93 100644
--- a/src/libImaging/FliDecode.c
+++ b/src/libImaging/FliDecode.c
@@ -144,6 +144,7 @@ ImagingFliDecode(Imaging im, ImagingCodecState state, UINT8* buf, Py_ssize_t byt
 	    y = I16(data); ymax = y + I16(data+2); data += 4;
 	    for (; y < ymax && y < state->ysize; y++) {
 		UINT8* out = (UINT8*) im->image[y];
+                ERR_IF_DATA_OOB(1)
 		int p, packets = *data++;
 		for (p = x = 0; p < packets; p++, x += i) {
 		    ERR_IF_DATA_OOB(2)

